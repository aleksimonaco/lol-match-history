var lolApp=angular.module("lolApp",["angular-loading-bar","ngAnimate","ngRoute"]);lolApp.config(function($interpolateProvider){$interpolateProvider.startSymbol("/*"),$interpolateProvider.endSymbol("*/")}),lolApp.config(["cfpLoadingBarProvider",function(cfpLoadingBarProvider){cfpLoadingBarProvider.includeSpinner=!1}]),lolApp.config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"/lol-match-history/app/js/templates/search.html",controller:"searchController"}).when("/match/:id",{templateUrl:"/lol-match-history/app/js/templates/matchDetails.html",controller:"matchDetailController"}).otherwise({redirectTo:"/"})}]);
lolApp.controller("searchController",["$scope","apiService","recentMatchesService",function($scope,apiService,recentMatchesService){$scope.searchKeyword="",$scope.matches=recentMatchesService.getMatches(),$scope.search=function(){apiService.getRecentMatches($scope.searchKeyword).then(function(data){void 0!==data&&recentMatchesService.setMatches(data.matches)})},$scope.$watch(function(){return recentMatchesService.getMatches()},function(newValue,oldValue){newValue!==oldValue&&($scope.matches=newValue)},!0)}]),lolApp.controller("matchDetailController",["$scope","$routeParams","recentMatchesService",function($scope,$routeParams,recentMatchesService){$scope.match=recentMatchesService.getMatch(parseInt($routeParams.id))}]);
lolApp.directive("recentMatch",["dateService",function(dateService){return{restrict:"E",scope:{match:"="},templateUrl:"/lol-match-history/app/js/lolApp/templates/matchInfo.html",link:function(scope,element,attrs){scope.match.since=dateService.getSince(scope.match.createDate)}}}]);
lolApp.service("apiService",function($http){function getRecentMatches(summonerName){function handleSuccess(response){return response.data}function handleError(response){console.log(response)}var request=$http({method:"POST",url:"/lol-match-history/search",data:{search_keyword:summonerName}});return request.then(handleSuccess,handleError)}return{getRecentMatches:getRecentMatches}}),lolApp.factory("recentMatchesService",function(){function setMatches(newData){matches=newData}function getMatches(){return matches}function getMatch(id){return _.findWhere(matches,{gameId:id})}var matches=[];return{setMatches:setMatches,getMatches:getMatches,getMatch:getMatch}}),lolApp.service("dateService",function(){function getSince(timestamp){return moment(timestamp).fromNow()}return{getSince:getSince}});